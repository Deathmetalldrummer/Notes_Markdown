# Git
![git](./img/git.png)

Настроить автозаполнение и показ веток в командной строке
## Настройка
### System

/etc/gitconfig
```
git config --system
```

### User
~/.gitconfig
```
git config --global
```

### Project
my_project/.git/config
```
git config
```

<br />

## Команды настроек
### Имя
```
git config --system user.name 'имя'
```

### Email
```
git config --system user.email 'email'
```

### Посмотреть настройки
```
git config --system --list
```

### Посмотреть имя/email
```
git config user.name/user.email
```

### Редактор по-умолчанию (для win)
```
git config --system core.editor 'notepad.exe'
```
```
git config --system core.editor "'C:/Program Files (x86)/Notepad++/notepad++.exe'"
```

С ключами для запуска notepad++ :
```
git config --system core.editor "'C:/Program Files (x86)/Notepad++/notepad++.exe' -multiInst -notabbar -nosession -noPlugin"
```

### Окрасить пользовательский интерфейс
```
git config --system color.ui true
```


## Help
### Вызов справочника (список команд)
```
git help
```

### Вызов справочника по отдельной команде
```
git help log
```



## Инициализация репозитория
### Создает репозиторий в текущей папке
```
git init
```

## Создание коммитов
Начиная с Git версии 2.0, поведение команды __add__ приведено в соответствие с поведением __commit__ и других комманд. Теперь . обозначает не всю рабочую область (working tree), а текущий путь в этой области.

### Добавить файлы в буфер
```
git add <file>
git add :/
git add :/path/to/files/
git add .
git add ./path
```
`:/` - путь относительно главной директории
<br />
`./` - путь относительно текущей директории
<br />
`.` - все файлы и директории в текущей директории



### Переименовать/переместить файл < file1 > в < file2 >
```
git mv <file1> <file2>
```

### Удалить файл из рабочей директории и сделать его неотслеживаемым
```
git rm <file>
```

### Удалить из буфера (сделать неотслеживаемым)
```
git rm --cached <file>
```

### Удалить из буфера (отменить изменения добавленные в буфер)
```
git reset HEAD <file>
```


### Сделать коммит
Будет выбран редактор по-умолчанию:
```
git commit
```

Метка `-m` позволяет задать сообщение из командной строки:
```
git commit -m 'сообщение'
```

### Изменить последний коммит
Откроется редактор по-умолчанию:
```
git commit --amend
```

Изменяет последние коммит с сообщением из командной строки:
```
git commit --amend -m 'сообщение'
```


### Добавление в буфер и коммит измененных файлов одной командой
```
git commit -a
git commit -am 'сообщение'
```
не работает для новых или удаленных файлов.только для измененных

### Переворачивает коммит и делает новый,обратный указанному
```
git revert SHA-1
```

## Reset
### --soft
Мягкий сброс (меняет только HEAD).Перемещает HEAD на указанный коммит (SHA-1) и больше ничего не делает
```
git reset --soft SHA-1
```

### --mixed (default)
Смешанный сброс (меняет HEAD и буфер).Перемещает HEAD на указанный коммит (SHA-1) и изменяет буфер.
```
git reset --mixed SHA-1
```

### --hard
Жесткий сброс (меняет HEAD,буфер и рабочую директорию).Перемещает HEAD на указанный коммит (SHA-1), изменяет буфер и рабочую директорию
```
git reset --hard SHA-1
```

<br />
<br />
<br />
#### Правильное написание сообщений для коммитов
* Для однострочных сообщений использовать < 50 символов
* Для многострочных сообщений каждая строка < 72 символов
* Писать сообщение в настоящем времени и писать что делает коммит,а не я или он
* Списки через тире или по договоренности
    * '[css,js]'
    * 'bugfix: '
    * '#38405 - '

<br />


## Логи коммитов
### Выводит список коммитов
```
git log
```

### Лимитированное число коммитов (например 2)
```
git log -n 2
```

### Коммиты после даты
```
git log --since=2016-11-26
git log --after=2016-11-26
```

### Коммиты до даты
```
git log --until=2016-11-26
git log --before=2016-11-26
```


```
git log --after='2 weeks ago' --before='3 days ago'
git log --after='2 weeks' --before='3 days'
git log --after=2.weeks --before=3.days
```

### Коммиты по автору
```
git log --author='Ragnarok'
```


### Поиск коммитов по регулярному выражению (например 'Init')
```
git log --grep='Init'
```


### Список коммитов в одну строку с маленьким SHA-1
```
git log --oneline
```


### Список коммитов в одну строку с полным SHA-1
```
git log --format=oneline
```

### Лимит коммитов в одну строку (например 3)
```
git log --oneline -3
```

### От одного коммита до другого
```
git log SHA-1..SHA-1 --oneline
```

### Все коммиты от
```
git log SHA-1.. <file>
```

### Подробное описание что происходило с файлами  в коммите
```
git log -p
```

### График коммитов
```
git log --graph
```

### Хорошая комбинация
```
git log --oneline --graph --all --decorate
```

### Подробно рассмотреть отдельный коммит
```
git show SHA-1
```


## Статус
### статус трех деревьев
```
git status
```

### Сравнение (показать изменения)
Сравнение изменений между репозиторием и рабочей директорией
```
git diff
```

### Сравнение  изменений в одном файле
```
git diff <file>
```

<!-- прочитать про опции diff -->
```
git diff --staged
```
### Сравнение между коммитом и текущим состоянием рабочей директории
```
git diff SHA-1
```

### Сравнение между файлом коммита и файлом в текущем состоянии рабочей директории
```
git diff SHA-1 <file>
```

### Сравнить два коммита
```
git diff SHA-1..SHA-1
git diff SHA-1..SHA-1 <file>
```


### Удалить неотслеживаемые файлы
```
git clean
git clean -n
git clean -f
```
опция `-n`  покажет что будет удалено
<br />
опция `-f` удалит неотслеживаемые файлы




## Checkout
Команда __checkout__ идет в репозиторий, берет указанную вещь и делает так чтобы рабочая директория выглядела так же.Если это файл,__checkout__ возвращает файл,если это ветка,__checkout__ возвращает верку.
например в рабочей директории есть измененный файл.Следующая команда отменит изменения и сделает указанный файл таким же как в репозитории:
```
git checkout <file>
```

Команда __checkout__ работает с файлами,директориями и ветками.в случае с файлом указывается тип файла (расширение)( text.txt ) и команде понятно что это файл,но в случае с директорией расширения нету и команда потянет ветку вместо директории.Поэтому чтобы указать что мы работаем не с веткой,а с файлами и директориями после команды указываем два дефиса:
```
git checkout -- directory
```
важно заметить что между командой, двумя дефисами и объектом существуют __пробелы__

<br />

```
git checkout SHA-1 -- <file>
```
вернёт файл в буфер из коммита по хэшу
<!-- найти инфу по этому -->



## Ветки

### Создание ветки (branch)
```
git branch <branch>
```

### Просмотр веток
```
git branch
```

### Просмотр удаленных веток
```
git branch -r
```

### Просмотр и локальных и удаленных веток
```
git branch -a
```

### Создать ветку из удаленной ветки и отслеживать ее
```
git branch <branch> <alias/branch>
```
### Переключение веток (на ветку branch)
```
git checkout <branch>
```

### Создание ветки (branch) и переключение на нее одной командой
```
git checkout -b <branch>
```

### Сравнение веток
```
git diff <branch 1>..<branch 2>
```

### Показать ветки которые полностью включены в текущую ветку
```
git branch --merged
```

### Переименовать ветку
```
git branch -m/--move <old branch> <new branch>
```
в юникс переименование и перемещение одно и то же

### Удалить ветку
```
git branch -d/--delete <branch>
```
git не позволит удалить ветку в которой мы находимся

Чтобы удалить ветку в которой есть новые,не слитые изменения,например новый коммит,используется заглавная `-D` :
```
git branch -D <branch>
```

### Слияние веток
```
git merge <branch>
```
ветка < branch > будет влита в текущую ветку

### Не применять быстрое слияние
```
git merge --no-ff <branch>
```

### Только быстрое слияние (если возможно)
```
git merge --ff-only <branch>
```

### Обрыв слияния
```
git merge --abort
```



#### Советы
* Создавать не длинные строки
* Делать много маленьких коммитов
* Не нужно вносить не принципиальные изменения (пробелы,табы,перенос строк)
* Делать слияния чаще
* Синхронизировать ветки.Следить за основной веткой


## Копилка
### Отправить в копилку
Отправляет изменения в копилку и возвращается к последнему коммиту ( git reset --hard HEAD ):
```
git stash save 'сообщение'
```

### Посмотреть копилки
```
git stash list
```
синтаксис копилки __stash@{0}__

### Посмотреть что в копилке
```
git stash show stash@{0}
git stash show -p stash@{0}
```

### Получить изменения из копилки
```
git stash pop/apply stash@{0}
```
__pop__ забирает изменения из копилки и удаляет элемент копилки
<br />
__apply__ просто копирует изменения из копилки (не удаляет элемент копилки)


### Удалить элемент из копилки
```
git stash drop stash@{0}
```

### Удалить все что находится в копилке
```
git stash clear
```



## Удаленный сервер

### Показать удаленные ветки < alias >
```
git remote
git remote -v
```
без опции `-v` будут показаны только имена,с ней - имена и ссылки

### Добавить репозиторий в удаленную ветку < alias >
```
git remote add <alias> <url>
```
__< alias >__ - произвольное имя удаленного сервера на локальном компьютере
__< url >__ - ссылка на удаленный репозиторий

### Удалить удаленную ветку < alias >
```
git remote rm <alias>
```

### Отправка на сервер
```
git push <alias> <branch>
git push -u <alias> <branch>
git push <alias> <branch1> <branch2>
git push <alias> --all
```
опция `-u` позволяет основной ветке отслеживать удаленную ветку.благодаря ей в дальнейшем можно не указывать альяс и ветку,а просто выполнять команду git push.Это действует для указанных альяса и ветки

Опция `--all` отправляет все ветки на сервер

### Клонирование репозитория
клонирует основную ветку:
```
git clone <url>
```

клонирует в указанную папку:
```
git clone <url> <directory>
```

клонирует указанную ветку из удаленного репозитория:
```
git clone -b <branch> <url>
```

### Извлечение данных с удаленного репозитория в <alias/branch> ( origin/master )
если один удаленный репозиторий:
```
git fetch
```
если удаленных репозиториев больше одного указываем с какого хотим забрать данные:
```
git fetch <alias>
```

#### Советы
* перед работой извлекать данные
* перед отправкой данных извлечь данные
* извлекать данные часто

### Извлечение и слияние
```
git pull
```
__pull__ двойная команда,включает в себя __fetch__ и __merge__
<br />
__ git pull = git fetch + git merge __


### Удалить ветку на удаленном репозитории (сервере )
<!-- отправить локальную ветку в ветку на удаленном репозитории
git push <alias> : <branch>
git push <alias> <branch>:<branch> -->
```
git push <alias> --delete <branch>
```
