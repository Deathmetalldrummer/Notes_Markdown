Local Storage, Session Storage, и Cookies представляют собой пары «ключ-значение» строкового типа

## Local Storage (локальное хранилище)

до 5 Мбайт данных

- Хранит данные бессрочно.
- Очищается только с помощью JavaScript или очистки кэша браузера.
- Хранит данные объёмом до 5 МБ, это самый большой объём из трёх вариантов хранилища.
- Не поддерживается старыми браузерами, например, IE 7 и ниже.
- Работает по правилу ограничения домена (same origin policy). То есть сохранённые данные доступны только для одного источника.

Возможность записи в `localStorage` доступна не всегда. Например, iOS Safari вернёт ошибку при попытке записать в `localStorage`, если браузер находится в приватном режиме

## Session Storage (сессионное хранилище)

Сессия — это конкретная вкладка браузера, а не браузер или окно.

- Хранит данные, пока продолжается текущая сессия. Когда пользователь закрывает браузер, данные становятся недоступными.
- Используется контекст браузера верхнего уровня, поэтому каждая вкладка браузера хранит уникальные данные.
- Объём данных больше чем в Cookie.
- Не поддерживается старыми браузерами, например, IE 7 и ниже.

## Cookie

4 Кбайт

- Хранит данные, которые можно передавать на сервер через **заголовки**.
- Локальное и сессионное хранилище доступны только на клиентской стороне.
- Срок хранения устанавливается при создании cookie.
- Объём данных не превышает 4 Кбайт.
- Cookie могут быть защищёнными, в этом случае их содержимое нельзя получить на стороне клиента. Это важно для аутентификации при хранении пользовательских токенов.

**Файлы cookie в основном используются в следующих трех областях:**
- Управление состоянием сеанса (например, состояние входа пользователя, корзина покупок)
- Персональные настройки (например, пользовательские настройки)
- Отслеживание поведения браузера (например, отслеживание и анализ поведения пользователя).

**Дефекты cookie:**
- Каждый HTTP-запрос содержит файлы cookie, из-за которых передача тех же данных замедляет работу нашего веб-приложения.
- Каждый HTTP-запрос содержит файлы cookie, что приводит к отправке незашифрованных данных в Интернет. (Если не используется HTTPS)
- Файлы cookie могут хранить только ограниченный объем данных в 4 КБ, чего недостаточно для сложных требований к хранилищу.

Cookies тоже являются domain specific, то есть привязаны только к конкретному домену, могут храниться очень долго. Но, в отличие от прошлых хранилищ, они **пересылаются с каждым исходящим HTTP/HTTPS запросом на сервер**. Их можно читать и записывать со стороны сервера. При записи они будут добавлены в HTTP ответ, чтобы браузер пользователя их запомнил.

## IndexedDB (индексированная база данных)

IndexedDB – это встроенная база данных, более мощная, чем `localStorage`.

- Хранилище ключей/значений: доступны несколько типов ключей, а значения могут быть (почти) любыми.
- Поддерживает транзакции для надёжности.
- Поддерживает запросы в диапазоне ключей и индексы.
- Позволяет хранить больше данных, чем `localStorage`.

Для традиционных клиент-серверных приложений эта мощность обычно чрезмерна. IndexedDB предназначена для оффлайн приложений, можно совмещать с ServiceWorkers и другими технологиями.

### Транзакции

Термин «транзакция» является общеизвестным, транзакции используются во многих видах баз данных.

Транзакция – это группа операций, которые должны быть или все выполнены, или все невыполнены (всё или ничего).

Например, когда пользователь что-то покупает, нам нужно:

1. Вычесть деньги с его счёта.
2. Отправить ему покупку.

Будет очень плохо, если мы успеем завершить первую операцию, а затем что-то пойдёт не так, например отключат электричество, и мы не сможем завершить вторую операцию. Обе операции должны быть успешно завершены (покупка сделана, отлично!) или необходимо отменить обе операции (в этом случае пользователь сохранит свои деньги и может попытаться купить ещё раз).

Транзакции гарантируют это.

**Все операции с данными в IndexedDB могут быть сделаны только внутри транзакций.**

## Разница между Local Storage, Session Storage, и Cookies

| Локальное хранилище                                          | Сессионное хранилище                                         | Cookies                                                      |
| ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
| Емкость локального хранилища составляет 5 МБ / 10 МБ.        | Объём хранилища сеансов составляет 5 МБ.                     | 4 КБ.                                                        |
| Поскольку он не основан на сеансе, его необходимо удалить с помощью javascript или вручную. | Он основан на сеансах и работает для каждого окна или вкладки. Это означает, что данные хранятся только на время сеанса, то есть до закрытия браузера (или вкладки). | Срок действия файлов cookie истекает в зависимости от настроек и работы для каждой вкладки и окна. |
| Клиент может читать только локальное хранилище               | Клиент может читать только локальное хранилище               | И клиенты, и серверы могут читать и записывать файлы cookie. |
| Нет передачи данных на сервер                                | Нет передачи данных на сервер                                | Передача данных на сервер существует                         |
| Меньше старых браузеров, которые его поддерживают            | Меньше старых браузеров, которые его поддерживают            | Поддерживается всеми браузерами, включая старые версии.      |

